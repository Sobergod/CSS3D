<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: css3d.collision.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: css3d.collision.js</h1>

    


    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * CSS 3D engine
 *
 * @category    css3d
 * @package     css3d.collision
 * @author      Jan Fischer, bitWorking &lt;info@bitworking.de>
 * @copyright   2014 Jan Fischer
 * @license     http://www.opensource.org/licenses/mit-license.html  MIT License
 */

/**
 * 
 * @name css3d.collision
 * @class
 * @param {Array} elements
 * @returns {css3d.collision}
 */
css3d.collision = (function()
{
    /**
     * 
     * @param {Array} elements
     * @returns {css3d.collision}
     */
    var collision = function(elements)
    {        
        this._elements = elements;
    }
    
    /**
     * 
     * @memberof! css3d.collision
     * @instance
     * @param {css3d.vector3} position
     * @param {css3d.vector3} normal
     * @param {Number} distance
     * @returns {Array}
     */
    collision.prototype.getCollisions = function(position, normal, distance)
    {
        var collisionPoint = new css3d.vector3(
            position.x + (normal.x * distance),
            position.y + (normal.y * distance),
            position.z + (normal.z * distance)
        );

        var elementPosition, elementDistance, elementSize, planeDistance;
        var collisionElements = [];
	
        for (var i=0;i&lt;this._elements.length;i++) {            
            if (null == this._elements[i]._domElement) {
                continue;
            }    
            
            elementPosition = this._elements[i].getTotalTranslation();
            elementDistance = css3d.vector3.prototype.distance(elementPosition, collisionPoint);
            elementSize = Math.max(
                this._elements[i]._domElement.offsetWidth / 2,
                this._elements[i]._domElement.offsetHeight / 2
            );
 
            if (elementDistance &lt; elementSize) {
                elementPosition.sub(collisionPoint);
                planeDistance = css3d.vector3.prototype.dot2(this._elements[i].normalWorld, elementPosition);
                //console.log(planeDistance);
                      
                //if (planeDistance &lt;= 0) {
                if (Math.abs(planeDistance) &lt; distance) { // normally &lt;= 0, but if the steps are too large the collision is missed
                    //this._elements[i]._domElement.style.border = '1px solid red';                    
                    collisionElements.push(this._elements[i]);
                }                
            }
            else {
                //this._elements[i]._domElement.style.border = 'none';
            }            
        }        
        return collisionElements;        
    }

    return collision;
}());


</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Index</a></h2><h3>Classes</h3><ul><li><a href="css3d.html">css3d</a></li><li><a href="css3d.camera.html">camera</a></li><li><a href="css3d.collision.html">collision</a></li><li><a href="css3d.element.html">element</a></li><li><a href="css3d.quaternion.html">quaternion</a></li><li><a href="css3d.scene.html">scene</a></li><li><a href="css3d.vector3.html">vector3</a></li><li><a href="css3d.vector4.html">vector4</a></li></ul><h3>Namespaces</h3><ul><li><a href="css3d.ajax.html">ajax</a></li><li><a href="css3d.elementFactory.html">elementFactory</a></li><li><a href="css3d.math.html">math</a></li><li><a href="css3d.math.interpolation.html">interpolation</a></li><li><a href="css3d.matrix4.html">matrix4</a></li></ul>
</nav>

<br clear="both">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.0-alpha9</a> on Fri Jul 11 2014 18:22:37 GMT+0200 (Mitteleurop√§ische Sommerzeit)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
